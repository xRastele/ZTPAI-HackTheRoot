CREATE TABLE "user" (
    id_user SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    is_admin BOOLEAN DEFAULT FALSE
);

CREATE TABLE difficulty (
    id_difficulty SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL
);

CREATE TABLE reward (
    id_reward SERIAL PRIMARY KEY,
    points INTEGER NOT NULL
);

CREATE TABLE challenge (
    id_challenge SERIAL PRIMARY KEY,
	title VARCHAR(255);
    id_reward INTEGER REFERENCES reward(id_reward),
    id_difficulty INTEGER REFERENCES difficulty(id_difficulty)
);

CREATE TABLE rank (
    id_rank SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    min_points INTEGER,
    max_points INTEGER
);

CREATE TABLE notification (
    id_notification SERIAL PRIMARY KEY,
    id_user INTEGER REFERENCES "user"(id_user),
    notification_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    notification_text TEXT
);

CREATE TABLE leaderboard (
	id_leaderboard SERIAL PRIMARY KEY,
    id_user INTEGER REFERENCES "user"(id_user),
    points INTEGER NOT NULL DEFAULT 0
);

CREATE TABLE progress (
    id_progress SERIAL PRIMARY KEY,
    id_user INTEGER REFERENCES "user"(id_user),
    id_challenge INTEGER REFERENCES challenge(id_challenge),
    is_completed BOOLEAN,
    completed_date TIMESTAMP
);

CREATE TABLE learning_path (
    id_learning_path SERIAL PRIMARY KEY,
    description TEXT,
    title VARCHAR(255)
);

CREATE TABLE lesson (
    id_lesson SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL
);

CREATE TABLE learning_path_lesson (
    id_learning_path_lesson SERIAL PRIMARY KEY,
    id_learning_path INTEGER REFERENCES learning_path(id_learning_path),
    id_lesson INTEGER REFERENCES lesson(id_lesson)
);

CREATE TABLE setting (
    id_user INTEGER PRIMARY KEY REFERENCES "user"(id_user),
    referral_code VARCHAR(50),
    referral_count INTEGER DEFAULT 0
);

CREATE TABLE user_rank (
    id_user_rank SERIAL PRIMARY KEY,
    id_user INTEGER REFERENCES "user"(id_user),
    id_rank INTEGER REFERENCES rank(id_rank)
);
